{"title":{"en":"B2. Wonderful Coloring - 2","ru":"B2. Чудесная раскраска - 2"},"contestId":"1551","problemIndex":"B2","timeLimit":{"en":"2 seconds","ru":"2 секунды"},"memLimit":{"en":"256 megabytes","ru":"256 мегабайт"},"inputFormat":{"en":"standard input","ru":"стандартный ввод"},"outputFormat":{"en":"standard output","ru":"стандартный вывод"},"problemHtml":{"en":"<p><span class=\"tex-font-style-it\">This problem is an extension of the problem \"Wonderful Coloring - 1\". It has quite many differences, so you should read this statement completely.</span></p><p>Recently, Paul and Mary have found a new favorite sequence of integers $$$a_1, a_2, \\dots, a_n$$$. They want to paint it using pieces of chalk of $$$k$$$ colors. The coloring of a sequence is called <span class=\"tex-font-style-it\">wonderful</span> if the following conditions are met:</p><ol> <li> each element of the sequence is either painted in one of $$$k$$$ colors or isn't painted; </li><li> each two elements which are painted in the same color are different (i. e. there's no two equal values painted in the same color); </li><li> let's calculate for each of $$$k$$$ colors the number of elements painted in the color — all calculated numbers must be equal; </li><li> the total number of painted elements of the sequence is the <span class=\"tex-font-style-bf\">maximum</span> among all colorings of the sequence which meet the first three conditions. </li></ol><p>E. g. consider a sequence $$$a=[3, 1, 1, 1, 1, 10, 3, 10, 10, 2]$$$ and $$$k=3$$$. One of the wonderful colorings of the sequence is shown in the figure.</p><center> <img class=\"tex-graphics\" src=\"https://espresso.codeforces.com/b2117ab8e16470ba572bc56a594d8c701e3f6378.png\" style=\"max-width: 100.0%;max-height: 100.0%;\">   <span class=\"tex-font-size-small\">The example of a wonderful coloring of the sequence $$$a=[3, 1, 1, 1, 1, 10, 3, 10, 10, 2]$$$ and $$$k=3$$$. Note that one of the elements isn't painted.</span> </center><p>Help Paul and Mary to find a wonderful coloring of a given sequence $$$a$$$.</p>","ru":"<p><span class=\"tex-font-style-it\">Эта задача является продолжением задачи «Чудесная раскраска - 1». Она имеет довольно много отличий, поэтому прочтите это условие полностью.</span></p><p>Совсем недавно у Паши и Маши появилась любимая последовательность чисел $$$a_1, a_2, \\dots, a_n$$$. Они захотели и её раскрасить с помощью мелков $$$k$$$ цветов. Раскраска последовательности называется <span class=\"tex-font-style-it\">чудесной</span>, если выполняются следующие условия:</p><ol> <li> каждый элемент последовательности раскрашивается ровно в один из $$$k$$$ цветов, либо не раскрашивается вовсе; </li><li> любые два элемента, раскрашенные в один цвет, различны (то есть нет двух одинаковых значений, которые раскрашены в один цвет); </li><li> посчитаем для каждого из $$$k$$$ цветов количество элементов, раскрашенных этот цвет — все полученные количества должны быть равны; </li><li> суммарное количество раскрашенных элементов при соблюдении первых трёх условий <span class=\"tex-font-style-bf\">максимально возможно</span>. </li></ol><p>Например, пусть последовательность имеет вид $$$a=[3, 1, 1, 1, 1, 10, 3, 10, 10, 2]$$$ и $$$k=3$$$. Одна из чудесных раскрасок изображена на рисунке.</p><center> <img class=\"tex-graphics\" src=\"https://espresso.codeforces.com/b2117ab8e16470ba572bc56a594d8c701e3f6378.png\" style=\"max-width: 100.0%;max-height: 100.0%;\">   <span class=\"tex-font-size-small\">Пример возможной чудесной раскраски для $$$a=[3, 1, 1, 1, 1, 10, 3, 10, 10, 2]$$$ и $$$k=3$$$. Обратите внимание, что один из элементов остался нераскрашенным.</span> </center><p>Помогите Паше и Маше найти чудесную раскраску заданной последовательности $$$a$$$.</p>"},"inSpecsHtml":{"en":"<div class=\"section-title\">Input</div><p>The first line contains one integer $$$t$$$ ($$$1 \\le t \\le 10000$$$) — the number of test cases. Then $$$t$$$ test cases follow.</p><p>Each test case consists of two lines. The first one contains two integers $$$n$$$ and $$$k$$$ ($$$1 \\le n \\le 2\\cdot10^5$$$, $$$1 \\le k \\le n$$$) — the length of a given sequence and the number of colors, respectively. The second one contains $$$n$$$ integers $$$a_1, a_2, \\dots, a_n$$$ ($$$1 \\le a_i \\le n$$$).</p><p>It is guaranteed that the sum of $$$n$$$ over all test cases doesn't exceed $$$2 \\cdot 10^5$$$.</p>","ru":"<div class=\"section-title\">Входные данные</div><p>В первой строке записано одно целое число $$$t$$$ ($$$1 \\le t \\le 10000$$$) — количество наборов входных данных. Далее следуют $$$t$$$ наборов входных данных.</p><p>Каждый набор входных данных состоит из двух строк. Первая из них содержит два целых числа $$$n$$$ и $$$k$$$ ($$$1 \\le n \\le 2\\cdot10^5$$$, $$$1 \\le k \\le n$$$) — длину заданной последовательности и количество цветов. Вторая из них содержит $$$n$$$ целых чисел $$$a_1, a_2, \\dots, a_n$$$ ($$$1 \\le a_i \\le n$$$).</p><p>Гарантируется, что сумма значений $$$n$$$ по всем наборам входных данных теста не превосходит $$$2 \\cdot 10^5$$$.</p>"},"outSpecsHtml":{"en":"<div class=\"section-title\">Output</div><p>Output $$$t$$$ lines, each of them must contain a description of a wonderful coloring for the corresponding test case.</p><p>Each wonderful coloring must be printed as a sequence of $$$n$$$ integers $$$c_1, c_2, \\dots, c_n$$$ ($$$0 \\le c_i \\le k$$$) separated by spaces where</p><ul> <li> $$$c_i=0$$$, if $$$i$$$-th element isn't painted; </li><li> $$$c_i&gt;0$$$, if $$$i$$$-th element is painted in the $$$c_i$$$-th color. </li></ul><p>Remember that you need to maximize the total count of painted elements for the wonderful coloring. If there are multiple solutions, print any one.</p>","ru":"<div class=\"section-title\">Выходные данные</div><p>Выведите $$$t$$$ строк, каждая строка содержит описание возможной чудесной раскраски для соответствующего набора входных данных.</p><p>Каждая чудесная раскраска должна быть выведена в виде $$$n$$$ целых чисел $$$c_1, c_2, \\dots, c_n$$$ ($$$0 \\le c_i \\le k$$$), где:</p><ul> <li> $$$c_i=0$$$, если $$$i$$$-й элемент не раскрашен в какой-либо цвет; </li><li> $$$c_i&gt;0$$$, если $$$i$$$-й элемент раскрашен в цвет с номером $$$c_i$$$. </li></ul><p>Помните, что в чудесной раскраске максимизируется суммарное количество раскрашенных элементов. Если существует несколько решений, выведите любое из них.</p>"},"noteHtml":{"en":"<div class=\"section-title\">Note</div><p>In the first test case, the answer is shown in the figure in the statement. The red color has number $$$1$$$, the blue color — $$$2$$$, the green — $$$3$$$.</p>","ru":"<div class=\"section-title\">Примечание</div><p>В первом наборе входных данных примера ответ соответствует картинке в условии. Красный цвет имеет номер $$$1$$$, синий имеет номер $$$2$$$, зелёный — номер $$$3$$$.</p>"},"sampleTestcases":[{"id":1651735176886,"input":"6\n10 3\n3 1 1 1 1 10 3 10 10 2\n4 4\n1 1 1 1\n1 1\n1\n13 1\n3 1 4 1 5 9 2 6 5 3 5 8 9\n13 2\n3 1 4 1 5 9 2 6 5 3 5 8 9\n13 3\n3 1 4 1 5 9 2 6 5 3 5 8 9\n","output":"1 1 0 2 3 2 2 1 3 3\n4 2 1 3\n1\n0 0 1 1 0 1 1 1 0 1 1 1 0\n2 1 2 2 1 1 1 1 2 1 0 2 2\n1 1 3 2 1 3 3 1 2 2 3 2 0\n"}],"submitUrl":"https://codeforces.com/contest/1551/submit","language":"c++"}